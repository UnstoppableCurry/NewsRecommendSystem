package com.wtx.job014.movie

import org.apache.spark.sql.SparkSession
import org.apache.log4j.Logger
import org.apache.log4j.Level

object MovieSimilartities_1 {

  Logger.getLogger("org").setLevel(Level.OFF)
  Logger.getLogger("akka").setLevel(Level.OFF)
  //日志等级
  val spark: SparkSession = SparkSession.builder().appName("moviesDemo").master("local[*]").getOrCreate()
  //创建sparksession会话

  val TRAIN_FILENAME = "file:\\C:\\Users\\86183\\Desktop\\scala_machine_leraning_projects\\ScalaMachineLearningData\\电影推荐\\ml-100k训练集\\ml-100k\\ua.base";
  val TEST_FIELNAME = "file:\\C:\\Users\\86183\\Desktop\\scala_machine_leraning_projects\\ScalaMachineLearningData\\电影推荐\\ml-100k训练集\\ml-100k\\ua.test";
  val MOVIES_FILENAME = "file:\\C:\\Users\\86183\\Desktop\\scala_machine_leraning_projects\\ScalaMachineLearningData\\电影推荐\\ml-100k训练集\\ml-100k\\u.item";

  val movies = spark.sparkContext.textFile(MOVIES_FILENAME)
    .map(line => {
      val fileds = line.split("\\|")
      (fileds(0).toInt, fileds(1)) //split先切分,然后将数组的第0个和第1个元素按照map格式(也就是键值对格式)存储起来
    })
  val movieNames = movies.collectAsMap() //如果集合不进行转换,那么原本的数据格式为sparkpartitionRDD
  // println(movieNames)//Map(137 -> Big Night (1996), 891 -> Bent (1997), 550 -> Die Hard: With a Vengeance (1995), 1205 ->
  val ratings = spark.sparkContext.textFile(TRAIN_FILENAME).map(
    line => {
      val fileds = line.split("\t")
      (fileds(0).toInt, fileds(1).toInt, fileds(2).toInt)
    })

  //从评级中提取数据
  val numRatersPerMovies = ratings.groupBy(tup => tup._2).map(grouped => (grouped._1, grouped._2.size))
  //    println(numRatersPerMovies.collectAsMap())
  //把电影id加上评级
  val ratingsWithSize = ratings.groupBy(tup => tup._2).join(numRatersPerMovies).flatMap(joined => { joined._2._1.map(f => (f._1, f._2, f._3, joined._2._2)) })
  //    println(ratingsWithSize)
  //join关联表操作,flatmap按照指定格式生成map
  val ratings2 = ratingsWithSize.keyBy(tup => tup._1)
  val ratingPairs = ratingsWithSize.keyBy(tup => tup._1).join(ratings2).filter(f => f._2._1._2 < f._2._2._2)
  /**
   * println(ratings2.collectAsMap())
   * println(ratingPairs.collectAsMap())
   * Map(137 -> (137,183,5,270), 891 -> (891,107,5,37), 146 -> (146,301,2,186), 864 -> (864,47,5,124), 550 -> (550,877,4,42), 559 -> (559,233,3,115), 218 -> (218,47,4,124), 568 -> (568,179,2,201), 227 -> (227,405,2,303), 765 -> (765,137,5,155), 774 -> (774,537,2,29), 92 -> (92,147,2,159), 433 -> (433,205,3,128), 846 -> (846,1249,3,12), 101 -> (101,147,4,159), 442 -> (442,873,2,68), 855 -> (855,475,4,222), 200 -> (200,147,5,159), 173 -> (173,687,1,58), 514 -> (514,183,3,270), 523 -> (523,155,4,96), 209 -> (209,1105,2,14), 182 -> (182,15,4,255), 191 -> (191,345,4,55), 254 -> (254,183,4,270), 720 -> (720,887,5,55), 729 -> (729,313,3,278), 828 -> (828,207,4,63), 424 -> (424,323,5,192), 738 -> (738,147,3,159), 83 -> (83,233,4,115), 837 -> (837,125,5,223), 496 -> (496,147,3,159), 810 -> (810,873,3,68), 155 -> (155,331,3,88), 469 -> (469,495,5,54), 819 -> (819,147,5,159), 478 -> (478,739,4,154), 505 -> (505,207,3,63), 164 -> (164,407,2,38), 577 -> (577,147,4,159), 245 -> (245,133,2,160), 783 -> (783,887,5,55), 792 -> (792,147,4,159), 110 -> (110,1249,3,12), 451 -> (451,991,2,23), 801 -> (801,681,1,24), 460 -> (460,1251,3,8), 119 -> (119,147,4,159), 873 -> (873,875,1,39), 532 -> (532,147,4,159), 128 -> (128,873,1,68), 541 -> (541,1041,3,60), 882 -> (882,147,4,159), 406 -> (406,521,3,115), 747 -> (747,739,3,154), 756 -> (756,147,4,159), 415 -> (415,323,2,192), 487 -> (487,739,2,154), 236 -> (236,521,3,115), 678 -> (678,15,3,255), 23 -> (23,155,3,96), 741 -> (741,1041,4,60), 95 -> (95,739,3,154), 436 -> (436,537,4,29), 777 -> (777,521,5,115), 104 -> (104,147,3,159), 445 -> (445,147,2,159), 517 -> (517,405,4,303), 732 -> (732,289,3,208), 391 -> (391,47,4,124), 472 -> (472,739,5,154), 131 -> (131,813,3,48), 427 -> (427,989,5,27), 463 -> (463,147,3,159), 122 -> (122,1119,3,53), 194 -> (194,155,3,96), 508 -> (508,47,3,124), 176 -> (176,927,3,6), 750 -> (750,873,3,68), 723 -> (723,433,3,160), 409 -> (409,207,3,63), 759 -> (759,323,4,192), 418 -> (418,1313,2,12), 77 -> (77,183,5,270), 804 -> (804,155,3,96), 490 -> (490,289,1,208), 831 -> (831,687,2,58), 86 -> (86,289,3,208), 185 -> (185,47,4,124), 158 -> (158,233,3,115), 499 -> (499,521,4,115), 167 -> (167,521,5,115), 50 -> (50,15,2,255), 705 -> (705,377,4,11), 364 -> (364,687,1,58), 400 -> (400,301,4,186), 714 -> (714,323,4,192), 59 -> (59,147,5,159), 373 -> (373,155,4,96), 32 -> (32,405,4,303), 813 -> (813,243,3,111), 68 -> (68,409,3,63), 382 -> (382,717,3,76), 786 -> (786,183,4,270), 41 -> (41,205,4,128), 822 -> (822,101,2,71), 140 -> (140,873,2,68), 481 -> (481,207,3,63), 795 -> (795,739,1,154), 454 -> (454,147,3,159), 113 -> (113,323,4,192), 149 -> (149,323,2,192), 687 -> (687,323,2,192), 660 -> (660,739,2,154), 346 -> (346,147,4,159), 696 -> (696,899,3,8), 355 -> (355,1429,4,3), 669 -> (669,183,3,270), 768 -> (768,405,4,303), 735 -> (735,147,1,159), 53 -> (53,15,5,255), 708 -> (708,147,4,159), 367 -> (367,183,5,270), 394 -> (394,233,3,115), 403 -> (403,147,5,159), 62 -> (62,147,3,159), 134 -> (134,15,5,255), 941 -> (941,273,3,200), 600 -> (600,233,2,115), 609 -> (609,147,1,159), 681 -> (681,1105,3,14), 376 -> (376,223,4,124), 690 -> (690,233,3,115), 35 -> (35,333,4,202), 349 -> (349,325,3,104), 8 -> (8,233,4,115), 762 -> (762,749,1,44), 699 -> (699,147,2,159), 44 -> (44,147,4,159), 17 -> (17,323,1,192), 358 -> (358,179,4,201), 771 -> (771,873,3,68), 430 -> (430,101,2,71), 26 -> (26,323,2,192), 125 -> (125,1249,3,12), 645 -> (645,521,4,115), 331 -> (331,811,4,17), 672 -> (672,15,3,255), 304 -> (304,323,3,192), 654 -> (654,147,3,159), 340 -> (340,205,4,128), 421 -> (421,183,5,270), 80 -> (80,205,5,128), 89 -> (89,739,2,154), 627 -> (627,233,2,115), 286 -> (286,147,5,159), 636 -> (636,15,5,255), 295 -> (295,155,4,96), 717 -> (717,147,4,159), 923 -> (923,1001,1,17), 448 -> (448,887,2,55), 932 -> (932,155,3,96), 457 -> (457,147,5,159), 116 -> (116,47,3,124), 663 -> (663,147,3,159), 744 -> (744,657,5,121), 753 -> (753,183,1,270), 412 -> (412,357,4,243), 439 -> (439,147,4,159), 98 -> (98,523,5,150), 71 -> (71,289,2,208), 107 -> (107,323,1,192), 618 -> (618,233,3,115), 313 -> (313,147,4,159), 726 -> (726,323,3,192), 385 -> (385,739,1,154), 322 -> (322,521,5,115), 11 -> (11,739,3,154), 908 -> (908,147,2,159), 567 -> (567,521,3,115), 639 -> (639,155,3,96), 648 -> (648,377,3,11), 307 -> (307,739,2,154), 74 -> (74,137,3,155), 388 -> (388,323,4,192), 397 -> (397,991,1,23), 56 -> (56,233,1,115), 935 -> (935,405,4,303), 603 -> (603,183,4,270), 262 -> (262,147,3,159), 702 -> (702,289,2,208), 298 -> (298,485,3,117), 370 -> (370,183,4,270), 711 -> (711,155,4,96), 29 -> (29,657,4,121), 343 -> (343,147,4,159), 684 -> (684,225,3,100), 379 -> (379,233,3,115), 693 -> (693,521,5,115), 38 -> (38,155,5,96), 352 -> (352,183,5,270), 47 -> (47,289,4,208), 576 -> (576,323,3,192), 585 -> (585,207,5,63), 926 -> (926,237,3,335), 558 -> (558,15,3,255), 899 -> (899,147,2,159), 244 -> (244,155,3,96), 594 -> (594,221,4,64), 226 -> (226,179,4,201), 253 -> (253,485,5,117), 666 -> (666,147,3,159), 325 -> (325,521,4,115), 361 -> (361,155,3,96), 334 -> (334,155,2,96), 20 -> (20,323,4,192), 675 -> (675,223,1,124), 2 -> (2,289,3,208), 872 -> (872,405,4,303), 881 -> (881,233,3,115), 540 -> (540,147,3,159), 549 -> (549,323,2,192), 890 -> (890,739,2,154), 235 -> (235,1105,2,14), 621 -> (621,233,3,115), 316 -> (316,521,5,115), 657 -> (657,873,3,68), 289 -> (289,147,3,159), 630 -> (630,687,3,58), 863 -> (863,873,2,68), 65 -> (65,1041,3,60), 917 -> (917,405,3,303), 612 -> (612,147,4,159), 271 -> (271,739,4,154), 280 -> (280,155,5,96), 319 -> (319,261,3,35), 5 -> (5,377,1,11), 857 -> (857,547,3,36), 516 -> (516,357,3,243), 830 -> (830,183,4,270), 552 -> (552,147,3,159), 866 -> (866,303,4,109), 525 -> (525,147,3,159), 184 -> (184,155,3,96), 534 -> (534,147,5,159), 597 -> (597,323,3,192), 938 -> (938,873,3,68), 193 -> (193,147,2,159), 606 -> (606,537,2,29), 265 -> (265,107,1,37), 301 -> (301,155,1,96), 615 -> (615,521,4,115), 812 -> (812,873,4,68), 821 -> (821,405,4,303), 848 -> (848,739,5,154), 480 -> (480,485,4,117), 175 -> (175,147,3,159), 893 -> (893,323,2,192), 256 -> (256,147,4,159), 803 -> (803,325,4,104), 337 -> (337,67,4,98), 211 -> (211,205,5,128), 624 -> (624,147,4,159), 283 -> (283,407,3,38), 633 -> (633,147,4,159), 292 -> (292,207,5,63), 498 -> (498,1103,4,19), 839 -> (839,323,4,192), 166 -> (166,687,1,58), 507 -> (507,405,5,303), 920 -> (920,301,2,186), 579 -> (579,183,4,270), 588 -> (588,155,5,96), 929 -> (929,521,5,115), 274 -> (274,873,3,68), 247 -> (247,181,4,439), 328 -> (328,155,4,96), 14 -> (14,813,2,48), 489 -> (489,991,3,23), 220 -> (220,289,4,208), 875 -> (875,1103,5,19), 561 -> (561,155,2,96), 902 -> (902,989,2,27), 911 -> (911,183,4,270), 570 -> (570,289,1,208), 229 -> (229,937,2,32), 884 -> (884,949,2,65), 543 -> (543,147,4,159), 202 -> (202,179,1,201), 642 -> (642,147,4,159), 238 -> (238,405,4,303), 651 -> (651,309,1,23), 310 -> (310,181,4,439), 277 -> (277,147,4,159), 815 -> (815,233,3,115), 474 -> (474,521,5,115), 824 -> (824,989,2,27), 483 -> (483,107,3,37), 142 -> (142,147,1,159), 492 -> (492,521,5,115), 151 -> (151,147,2,159), 896 -> (896,147,2,159), 905 -> (905,873,3,68), 250 -> (250,991,2,23), 564 -> (564,323,3,192), 223 -> (223,155,5,96), 259 -> (259,147,4,159), 232 -> (232,133,4,160), 573 -> (573,183,3,270), 770 -> (770,323,5,192), 124 -> (124,209,3,177), 779 -> (779,225,4,100), 438 -> (438,619,4,61), 878 -> (878,155,3,96), 537 -> (537,147,2,159), 133 -> (133,749,4,44), 851 -> (851,147,4,159), 447 -> (447,147,4,159), 106 -> (106,739,3,154), 887 -> (887,47,5,124), 860 -> (860,1041,2,60), 546 -> (546,717,5,76), 205 -> (205,875,2,39), 519 -> (519,991,2,23), 214 -> (214,179,5,201), 555 -> (555,147,4,159), 869 -> (869,125,3,223), 528 -> (528,213,4,128), 752 -> (752,1105,3,14), 761 -> (761,205,4,128), 420 -> (420,179,5,201), 833 -> (833,233,2,115), 429 -> (429,147,2,159), 743 -> (743,289,3,208), 842 -> (842,1395,4,6), 501 -> (501,147,3,159), 160 -> (160,55,4,136), 169 -> (169,213,5,128), 510 -> (510,873,3,68), 582 -> (582,405,3,303), 178 -> (178,147,4,159), 591 -> (591,47,3,124), 797 -> (797,309,3,23), 456 -> (456,739,3,154), 806 -> (806,155,3,96), 465 -> (465,179,3,201), 788 -> (788,739,2,154), 115 -> (115,183,5,270), 187 -> (187,179,5,201), 914 -> (914,739,2,154), 196 -> (196,153,5,230), 268 -> (268,1249,2,12), 241 -> (241,335,3,17), 369 -> (369,179,4,201), 782 -> (782,991,2,23), 441 -> (441,313,4,278), 181 -> (181,147,1,159), 809 -> (809,333,3,202), 163 -> (163,433,1,160), 477 -> (477,739,4,154), 172 -> (172,183,5,270), 513 -> (513,739,5,154), 387 -> (387,147,2,159), 46 -> (46,125,4,223), 800 -> (800,405,4,303), 459 -> (459,147,3,159), 118 -> (118,179,5,201), 432 -> (432,405,4,303), 468 -> (468,377,2,11), 127 -> (127,901,5,9), 854 -> (854,147,3,159), 199 -> (199,989,1,27), 136 -> (136,223,4,124), 208 -> (208,739,4,154), 217 -> (217,147,3,159), 683 -> (683,133,5,160), 728 -> (728,323,3,192), 755 -> (755,323,4,192), 100 -> (100,323,3,192), 414 -> (414,325,3,104), 764 -> (764,323,3,192), 450 -> (450,155,4,96), 109 -> (109,147,4,159), 82 -> (82,147,3,159), 423 -> (423,887,5,55), 836 -> (836,657,5,121), 495 -> (495,147,5,159), 522 -> (522,521,5,115), 91 -> (91,183,5,270), 531 -> (531,895,2,96), 504 -> (504,155,3,96), 845 -> (845,909,4,11), 190 -> (190,989,3,27), 396 -> (396,323,4,192), 737 -> (737,137,5,155), 55 -> (55,273,5,200), 710 -> (710,179,4,201), 405 -> (405,377,1,11), 746 -> (746,233,4,115), 64 -> (64,183,5,270), 719 -> (719,289,2,208), 378 -> (378,155,4,96), 818 -> (818,875,1,39), 791 -> (791,301,3,186), 73 -> (73,183,4,270), 486 -> (486,1093,4,21), 827 -> (827,289,3,208), 145 -> (145,155,2,96), 154 -> (154,191,4,249), 692 -> (692,523,3,150), 360 -> (360,521,5,115), 701 -> (701,289,4,208), 773 -> (773,233,1,115), 426 -> (426,205,4,128), 399 -> (399,147,5,159), 85 -> (85,521,3,115), 740 -> (740,873,2,68), 58 -> (58,1105,2,14), 94 -> (94,155,2,96), 67 -> (67,125,4,223), 408 -> (408,313,4,278), 139 -> (139,297,5,39), 300 -> (300,687,2,58), 686 -> (686,521,5,115), 623 -> (623,183,3,270), 381 -> (381,485,4,117), 722 -> (722,405,3,303), 40 -> (40,879,2,115), 354 -> (354,155,2,96), 695 -> (695,991,5,23), 704 -> (704,657,4,121), 390 -> (390,289,3,208), 49 -> (49,147,1,159), 130 -> (130,147,4,159), 471 -> (471,465,5,76), 937 -> (937,225,2,100), 677 -> (677,687,4,58), 336 -> (336,1249,3,12), 345 -> (345,739,4,154), 4 -> (4,301,5,186), 13 -> (13,147,3,159), 767 -> (767,183,4,270), 632 -> (632,233,3,115), 641 -> (641,1039,4,87), 713 -> (713,345,3,55), 372 -> (372,325,4,104), 794 -> (794,1251,4,8), 453 -> (453,233,2,115), 148 -> (148,521,1,115), 121 -> (121,125,2,223), 462 -> (462,873,4,68), 157 -> (157,147,5,159), 668 -> (668,323,4,192), 363 -> (363,155,2,96), 22 -> (22,233,3,115), 435 -> (435,155,3,96), 776 -> (776,179,4,201), 749 -> (749,155,2,96), 31 -> (31,1021,3,34), 444 -> (444,307,3,155), 758 -> (758,147,4,159), 103 -> (103,405,3,303), 785 -> (785,137,2,155), 76 -> (76,325,2,104), 417 -> (417,537,4,29), 112 -> (112,323,3,192), 650 -> (650,155,2,96), 309 -> (309,989,3,27), 659 -> (659,155,3,96), 318 -> (318,739,5,154), 731 -> (731,521,1,115), 327 -> (327,147,2,159), 698 -> (698,485,4,117), 357 -> (357,147,5,159), 16 -> (16,155,3,96), 97 -> (97,183,5,270), 563 -> (563,153,4,230), 653 -> (653,233,3,115), 312 -> (312,537,5,29), 7 -> (7,537,3,29), 348 -> (348,107,4,37), 79 -> (79,325,5,104), 393 -> (393,147,5,159), 734 -> (734,485,5,117), 88 -> (88,1191,5,3), 402 -> (402,15,5,255), 626 -> (626,323,1,192), 940 -> (940,147,4,159), 294 -> (294,147,4,159), 635 -> (635,323,3,192), 608 -> (608,207,5,63), 644 -> (644,873,4,68), 707 -> (707,155,3,96), 303 -> (303,147,4,159), 716 -> (716,521,3,115), 375 -> (375,233,4,115), 725 -> (725,873,4,68), 384 -> (384,289,5,208), 70 -> (70,739,2,154), 411 -> (411,485,4,117), 43 -> (43,155,4,96), 52 -> (52,107,4,37), 922 -> (922,155,2,96), 931 -> (931,459,4,23), 276 -> (276,147,4,159), 904 -> (904,155,4,96), 590 -> (590,125,3,223), 249 -> (249,147,5,159), 285 -> (285,183,4,270), 599 -> (599,1357,2,2), 258 -> (258,877,3,42), 671 -> (671,147,1,159), 267 -> (267,147,3,159), 330 -> (330,739,5,154), 680 -> (680,15,3,255), 339 -> (339,233,1,115), 25 -> (25,183,4,270), 366 -> (366,413,4,51), 34 -> (34,991,4,23), 572 -> (572,813,4,48), 913 -> (913,183,4,270), 886 -> (886,1093,1,21), 895 -> (895,885,2,12), 581 -> (581,137,5,155), 240 -> (240,873,2,68), 662 -> (662,13,4,164), 321 -> (321,485,4,117), 877 -> (877,155,2,96), 61 -> (61,301,1,186), 617 -> (617,183,4,270), 689 -> (689,405,5,303), 10 -> (10,155,4,96), 521 -> (521,147,4,159), 862 -> (862,147,5,159), 557 -> (557,739,3,154), 189 -> (189,207,5,63), 871 -> (871,147,5,159), 530 -> (530,183,4,270), 225 -> (225,705,5,128), 943 -> (943,233,5,115), 306 -> (306,1251,5,8), 817 -> (817,405,3,303), 512 -> (512,183,5,270), 853 -> (853,323,3,192), 37 -> (37,147,3,159), 180 -> (180,739,3,154), 665 -> (665,147,4,159), 333 -> (333,873,3,68), 674 -> (674,323,3,192), 1 -> (1,147,3,159), 342 -> (342,1103,3,19), 889 -> (889,147,3,159), 548 -> (548,147,5,159), 207 -> (207,233,3,115), 216 -> (216,147,4,159), 288 -> (288,205,5,128), 629 -> (629,147,5,159), 324 -> (324,873,5,68), 297 -> (297,147,3,159), 638 -> (638,405,3,303), 844 -> (844,207,4,63), 503 -> (503,233,5,115), 198 -> (198,183,5,270), 539 -> (539,155,4,96), 611 -> (611,873,3,68), 270 -> (270,155,5,96), 584 -> (584,227,4,148), 925 -> (925,325,4,104), 934 -> (934,183,2,270), 279 -> (279,147,4,159), 620 -> (620,147,3,159), 252 -> (252,149,5,23), 593 -> (593,155,5,96), 351 -> (351,989,4,27), 19 -> (19,325,4,104), 826 -> (826,233,4,115), 28 -> (28,323,3,192), 898 -> (898,309,5,23), 835 -> (835,485,5,117), 907 -> (907,147,5,159), 566 -> (566,155,2,96), 880 -> (880,147,4,159), 602 -> (602,261,3,35), 261 -> (261,687,5,58), 916 -> (916,147,1,159), 234 -> (234,147,3,159), 575 -> (575,357,5,243), 243 -> (243,713,3,69), 647 -> (647,147,4,159), 656 -> (656,903,2,15), 315 -> (315,183,3,270), 282 -> (282,333,3,202), 820 -> (820,895,2,96), 829 -> (829,213,4,128), 174 -> (174,147,4,159), 147 -> (147,301,5,186), 488 -> (488,521,3,115), 928 -> (928,191,5,249), 587 -> (587,989,2,27), 901 -> (901,155,5,96), 497 -> (497,155,3,96), 183 -> (183,739,4,154), 156 -> (156,157,4,121), 596 -> (596,289,3,208), 910 -> (910,183,4,270), 569 -> (569,325,1,104), 255 -> (255,147,4,159), 228 -> (228,137,1,155), 578 -> (578,325,1,104), 264 -> (264,1103,5,19), 461 -> (461,319,3,139), 802 -> (802,687,3,58), 775 -> (775,887,4,55), 811 -> (811,895,5,96), 129 -> (129,323,1,192), 470 -> (470,125,4,223), 784 -> (784,323,4,192), 443 -> (443,309,5,23), 883 -> (883,147,2,159), 138 -> (138,147,4,159), 479 -> (479,147,3,159), 542 -> (542,47,5,124), 452 -> (452,521,3,115), 551 -> (551,147,4,159), 892 -> (892,155,2,96), 210 -> (210,205,4,128), 560 -> (560,183,5,270), 219 -> (219,223,5,124), 291 -> (291,147,4,159), 757 -> (757,155,2,96), 766 -> (766,739,2,154), 120 -> (120,125,4,223), 838 -> (838,179,5,201), 847 -> (847,485,3,117), 506 -> (506,147,3,159), 165 -> (165,1119,3,53), 856 -> (856,289,1,208), 515 -> (515,687,3,58), 237 -> (237,485,4,117), 246 -> (246,155,1,96), 793 -> (793,405,3,303), 524 -> (524,739,2,154), 865 -> (865,405,2,303), 874 -> (874,521,5,115), 192 -> (192,125,3,223), 533 -> (533,147,1,159), 605 -> (605,521,5,115), 919 -> (919,147,4,159), 201 -> (201,537,3,29), 614 -> (614,147,5,159), 273 -> (273,307,2,155), 60 -> (60,207,3,63), 859 -> (859,955,5,46), 186 -> (186,147,4,159), 213 -> (213,521,4,115), 222 -> (222,147,4,159), 87 -> (87,233,4,115), 437 -> (437,155,3,96), 96 -> (96,183,4,270), 509 -> (509,289,2,208), 850 -> (850,485,5,117), 482 -> (482,881,3,38), 168 -> (168,323,3,192), 177 -> (177,47,3,124), 518 -> (518,147,4,159), 715 -> (715,155,4,96), 724 -> (724,1105,1,14), 383 -> (383,205,4,128), 733 -> (733,107,4,37), 796 -> (796,147,5,159), 392 -> (392,873,3,68), 150 -> (150,147,4,159), 805 -> (805,147,5,159), 464 -> (464,295,5,70), 500 -> (500,147,3,159), 814 -> (814,669,3,12), 473 -> (473,137,4,155), 159 -> (159,873,2,68), 132 -> (132,521,4,115), 141 -> (141,147,4,159), 545 -> (545,155,3,96), 554 -> (554,1041,3,60), 778 -> (778,405,3,303), 787 -> (787,877,2,42), 105 -> (105,313,5,278), 419 -> (419,405,3,303), 446 -> (446,887,4,55), 760 -> (760,739,4,154), 455 -> (455,147,4,159), 769 -> (769,1093,3,21), 428 -> (428,323,3,192), 114 -> (114,485,3,117), 527 -> (527,207,4,63), 123 -> (123,485,5,117), 841 -> (841,873,4,68), 868 -> (868,155,2,96), 195 -> (195,47,5,124), 536 -> (536,183,3,270), 204 -> (204,297,5,39), 742 -> (742,15,4,255), 401 -> (401,147,2,159), 751 -> (751,537,4,29), 410 -> (410,873,4,68), 69 -> (69,147,3,159), 78 -> (78,813,2,48), 823 -> (823,155,3,96), 832 -> (832,873,2,68), 491 -> (491,325,1,104), 697 -> (697,989,2,27), 231 -> (231,289,4,208), 706 -> (706,687,1,58), 332 -> (332,147,4,159), 772 -> (772,323,4,192), 745 -> (745,207,2,63), 90 -> (90,155,5,96), 404 -> (404,739,4,154), 431 -> (431,303,4,109), 63 -> (63,323,1,192), 99 -> (99,147,5,159), 646 -> (646,323,3,192), 727 -> (727,147,3,159), 386 -> (386,323,4,192), 45 -> (45,1001,3,17), 395 -> (395,739,3,154), 54 -> (54,147,5,159), 808 -> (808,875,4,39), 682 -> (682,147,1,159), 341 -> (341,881,5,38), 691 -> (691,205,5,128), 763 -> (763,47,3,124), 422 -> (422,323,3,192), 171 -> (171,887,4,55), 718 -> (718,405,5,303), 377 -> (377,1105,3,14), 72 -> (72,147,5,159), 413 -> (413,147,2,159), 485 -> (485,889,5,11), 144 -> (144,147,3,159), 81 -> (81,147,4,159), 799 -> (799,289,3,208), 494 -> (494,323,3,192), 153 -> (153,325,2,104), 126 -> (126,289,3,208), 467 -> (467,273,4,200), 162 -> (162,147,4,159), 359 -> (359,323,3,192), 700 -> (700,73,3,120), 673 -> (673,323,2,192), 27 -> (27,325,2,104), 709 -> (709,155,2,96), 368 -> (368,183,5,270), 781 -> (781,179,5,201), 440 -> (440,1105,5,14), 36 -> (36,873,3,68), 754 -> (754,459,4,23), 790 -> (790,155,3,96), 449 -> (449,983,2,13), 135 -> (135,183,4,270), 476 -> (476,47,3,124), 108 -> (108,405,3,303), 458 -> (458,147,2,159), 117 -> (117,179,5,201), 655 -> (655,155,4,96), 350 -> (350,183,3,270), 9 -> (9,385,5,195), 664 -> (664,47,4,124), 323 -> (323,873,3,68), 736 -> (736,323,1,192), 18 -> (18,739,3,154), 389 -> (389,155,2,96), 362 -> (362,1025,2,38), 703 -> (703,323,2,192), 48 -> (48,183,5,270), 21 -> (21,991,2,23), 57 -> (57,1093,3,21), 909 -> (909,261,5,35), 263 -> (263,521,3,115), 676 -> (676,687,1,58), 272 -> (272,521,5,115), 685 -> (685,289,2,208), 344 -> (344,537,4,29), 317 -> (317,879,3,115), 3 -> (3,325,1,104), 658 -> (658,55,4,136), 353 -> (353,301,3,186), 12 -> (12,133,4,160), 425 -> (425,147,3,159), 84 -> (84,225,4,100), 434 -> (434,147,3,159), 93 -> (93,125,1,223), 900 -> (900,205,4,128), 102 -> (102,233,3,115), 631 -> (631,873,2,68), 326 -> (326,233,4,115), 640 -> (640,233,4,115), 299 -> (299,739,3,154), 335 -> (335,323,4,192), 649 -> (649,181,4,439), 308 -> (308,147,3,159), 380 -> (380,521,2,115), 721 -> (721,991,3,23), 730 -> (730,873,2,68), 416 -> (416,147,5,159), 75 -> (75,1001,1,17), 927 -> (927,155,4,96), 622 -> (622,233,4,115), 281 -> (281,323,3,192), 936 -> (936,927,4,6), 595 -> (595,325,3,104), 290 -> (290,739,3,154), 604 -> (604,447,4,115), 712 -> (712,739,4,154), 371 -> (371,183,5,270), 30 -> (30,873,1,68), 39 -> (39,301,3,186), 918 -> (918,485,3,117), 111 -> (111,333,4,202), 586 -> (586,155,3,96), 667 -> (667,137,3,155), 398 -> (398,991,2,23), 739 -> (739,55,1,136), 66 -> (66,405,3,303), 407 -> (407,147,4,159), 748 -> (748,183,4,270), 613 -> (613,297,5,39), 694 -> (694,521,3,115), 356 -> (356,331,3,88), 15 -> (15,927,4,6), 867 -> (867,207,5,63), 903 -> (903,147,3,159), 562 -> (562,485,5,117), 230 -> (230,233,1,115), 858 -> (858,323,2,192), 42 -> (42,521,2,115), 51 -> (51,655,3,218), 939 -> (939,405,4,303), 598 -> (598,895,2,96), 257 -> (257,949,3,65), 679 -> (679,153,2,230), 24 -> (24,55,5,136), 338 -> (338,133,4,160), 33 -> (33,323,4,192), 374 -> (374,147,3,159), 688 -> (688,877,5,42), 347 -> (347,147,4,159), 6 -> (6,537,4,29), 885 -> (885,233,3,115), 894 -> (894,147,3,159), 553 -> (553,485,3,117), 652 -> (652,125,2,223), 248 -> (248,183,5,270), 589 -> (589,873,5,68), 221 -> (221,485,2,117), 634 -> (634,147,2,159), 320 -> (320,147,4,159), 661 -> (661,179,4,201), 670 -> (670,521,4,115), 643 -> (643,147,3,159), 329 -> (329,147,3,159), 302 -> (302,289,3,208), 849 -> (849,207,5,63), 535 -> (535,521,5,115), 876 -> (876,523,5,150), 203 -> (203,323,3,192), 544 -> (544,877,2,42), 930 -> (930,107,3,37), 616 -> (616,873,3,68), 275 -> (275,183,3,270), 212 -> (212,317,5,94), 311 -> (311,233,4,115), 625 -> (625,183,3,270), 284 -> (284,687,3,58), 293 -> (293,147,2,159), 365 -> (365,125,3,223), 526 -> (526,323,2,192), 840 -> (840,521,5,115), 912 -> (912,611,3,39), 571 -> (571,1039,3,87), 580 -> (580,147,3,159), 266 -> (266,325,1,104), 921 -> (921,147,3,159), 607 -> (607,485,3,117), 239 -> (239,207,5,63), 314 -> (314,147,4,159), 628 -> (628,301,4,186), 852 -> (852,407,3,38), 511 -> (511,887,5,55), 825 -> (825,147,5,159), 861 -> (861,179,1,201), 520 -> (520,893,2,11), 179 -> (179,917,3,7), 152 -> (152,155,5,96), 493 -> (493,687,1,58), 834 -> (834,323,2,192), 906 -> (906,991,3,23), 592 -> (592,147,4,159), 188 -> (188,233,3,115), 933 -> (933,233,2,115), 502 -> (502,687,4,58), 942 -> (942,183,3,270), 260 -> (260,881,4,38), 601 -> (601,47,3,124), 610 -> (610,485,5,117), 269 -> (269,537,5,29), 807 -> (807,739,4,154), 816 -> (816,687,2,58), 475 -> (475,303,1,109), 888 -> (888,153,4,230), 170 -> (170,687,3,58), 484 -> (484,233,5,115), 143 -> (143,307,4,155), 897 -> (897,521,5,115), 556 -> (556,133,5,160), 215 -> (215,183,5,270), 565 -> (565,207,4,63), 798 -> (798,155,3,96), 466 -> (466,183,3,270), 780 -> (780,485,4,117), 547 -> (547,289,3,208), 287 -> (287,1067,2,38), 843 -> (843,739,2,154), 161 -> (161,133,2,160), 915 -> (915,301,2,186), 574 -> (574,213,4,128), 583 -> (583,55,4,136), 242 -> (242,111,4,245), 924 -> (924,205,4,128), 251 -> (251,147,3,159), 789 -> (789,137,2,155), 529 -> (529,991,1,23), 870 -> (870,47,3,124), 197 -> (197,233,4,115), 538 -> (538,183,4,270), 224 -> (224,147,3,159), 879 -> (879,125,5,223), 296 -> (296,521,4,115), 233 -> (233,521,5,115), 637 -> (637,147,1,159), 206 -> (206,873,3,68), 305 -> (305,207,5,63), 619 -> (619,233,4,115), 278 -> (278,515,5,179))
   * Map(137 -> ((137,183,5,270),(137,405,5,303)), 891 -> ((891,107,5,37),(891,323,3,192)), 864 -> ((864,47,5,124),(864,183,4,270)), 550 -> ((550,877,4,42),(550,1089,3,35)), 146 -> ((146,301,2,186),(146,345,4,55)), 559 -> ((559,233,3,115),(559,521,2,115)), 218 -> ((218,47,4,124),(218,183,5,270)), 568 -> ((568,179,2,201),(568,213,4,128)), 227 -> ((227,405,2,303),(227,1067,4,38)), 765 -> ((765,137,5,155),(765,507,5,87)), 92 -> ((92,147,2,159),(92,155,2,96)), 774 -> ((774,537,2,29),(774,947,2,16)), 433 -> ((433,205,3,128),(433,323,1,192)), 846 -> ((846,1249,3,12),(846,1451,4,11)), 101 -> ((101,147,4,159),(101,1093,1,21)), 442 -> ((442,873,2,68),(442,1067,3,38)), 200 -> ((200,147,5,159),(200,739,4,154)), 855 -> ((855,475,4,222),(855,509,3,114)), 514 -> ((514,183,3,270),(514,949,3,65)), 173 -> ((173,687,1,58),(173,881,3,38)), 523 -> ((523,155,4,96),(523,1041,4,60)), 209 -> ((209,1105,2,14),(209,1137,4,27)), 182 -> ((182,15,4,255),(182,191,4,249)), 191 -> ((191,345,4,55),(191,891,3,6)), 254 -> ((254,183,4,270),(254,951,4,37)), 720 -> ((720,887,5,55),(720,898,4,48)), 729 -> ((729,313,3,278),(729,751,3,150)), 738 -> ((738,147,3,159),(738,233,3,115)), 828 -> ((828,207,4,63),(828,213,2,128)), 424 -> ((424,323,5,192),(424,681,3,24)), 83 -> ((83,233,4,115),(83,739,5,154)), 837 -> ((837,125,5,223),(837,289,5,208)), 155 -> ((155,331,3,88),(155,990,3,30)), 810 -> ((810,873,3,68),(810,881,4,38)), 496 -> ((496,147,3,159),(496,155,1,96)), 469 -> ((469,495,5,54),(469,611,5,39)), 164 -> ((164,407,2,38),(164,619,4,61)), 478 -> ((478,739,4,154),(478,1041,3,60)), 505 -> ((505,207,3,63),(505,951,3,37)), 819 -> ((819,147,5,159),(819,345,4,55)), 577 -> ((577,147,4,159),(577,739,3,154)), 245 -> ((245,133,2,160),(245,717,4,76)), 783 -> ((783,887,5,55),(783,895,4,96)), 792 -> ((792,147,4,159),(792,405,3,303)), 110 -> ((110,1249,3,12),(110,1250,3,5)), 451 -> ((451,991,2,23),(451,1395,1,6)), 801 -> ((801,681,1,24),(801,881,3,38)), 460 -> ((460,1251,3,8),(460,1380,3,6)), 119 -> ((119,147,4,159),(119,537,5,29)), 873 -> ((873,307,3,155),(873,875,1,39)), 532 -> ((532,147,4,159),(532,155,4,96)), 128 -> ((128,873,1,68),(128,949,4,65)), 882 -> ((882,147,4,159),(882,739,4,154)), 541 -> ((541,1041,3,60),(541,1091,3,39)), 747 -> ((747,739,3,154),(747,989,3,27)), 406 -> ((406,521,3,115),(406,1021,5,34)), 756 -> ((756,147,4,159),(756,155,4,96)), 415 -> ((415,323,2,192),(415,531,5,119)), 487 -> ((487,739,2,154),(487,789,4,45)), 236 -> ((236,521,3,115),(236,1039,2,87)), 678 -> ((678,15,3,255),(678,1115,3,27)), 741 -> ((741,1041,4,60),(741,1152,3,24)), 23 -> ((23,155,3,96),(23,739,2,154)), 777 -> ((777,521,5,115),(777,523,4,150)), 436 -> ((436,537,4,29),(436,739,4,154)), 95 -> ((95,739,3,154),(95,971,3,30)), 445 -> ((445,147,2,159),(445,183,2,270)), 104 -> ((104,147,3,159),(104,407,2,38)), 517 -> ((517,405,4,303),(517,823,2,73)), 391 -> ((391,47,4,124),(391,205,5,128)), 732 -> ((732,289,3,208),(732,937,4,32)), 472 -> ((472,739,5,154),(472,951,1,37)), 131 -> ((131,137,1,155),(131,813,3,48)), 427 -> ((427,989,5,27),(427,1265,5,19)), 463 -> ((463,147,3,159),(463,887,5,55)), 122 -> ((122,1119,3,53),(122,1267,4,31)), 194 -> ((194,155,3,96),(194,991,2,23)), 508 -> ((508,47,3,124),(508,183,5,270)), 176 -> ((176,927,3,6),(176,1097,4,17)), 750 -> ((750,873,3,68),(750,881,2,38)), 409 -> ((409,207,3,63),(409,485,2,117)), 723 -> ((723,433,3,160),(723,748,5,253)), 418 -> ((418,895,4,96),(418,1313,2,12)), 759 -> ((759,323,4,192),(759,405,4,303)), 77 -> ((77,183,5,270),(77,405,3,303)), 490 -> ((490,289,1,208),(490,1067,2,38)), 804 -> ((804,155,3,96),(804,233,4,115)), 86 -> ((86,289,3,208),(86,683,5,37)), 831 -> ((831,687,2,58),(831,1119,3,53)), 185 -> ((185,47,4,124),(185,205,3,128)), 158 -> ((158,233,3,115),(158,325,4,104)), 499 -> ((499,521,4,115),(499,657,5,121)), 167 -> ((167,521,5,115),(167,949,1,65)), 50 -> ((50,15,2,255),(50,547,4,36)), 705 -> ((705,377,4,11),(705,405,4,303)), 364 -> ((364,687,1,58),(364,990,4,30)), 714 -> ((714,323,4,192),(714,405,5,303)), 400 -> ((400,301,4,186),(400,313,5,278)), 373 -> ((373,155,4,96),(373,233,3,115)), 59 -> ((59,147,5,159),(59,739,4,154)), 32 -> ((32,405,4,303),(32,1023,3,29)), 813 -> ((813,243,3,111),(813,263,3,15)), 41 -> ((41,205,4,128),(41,1039,3,87)), 382 -> ((382,717,3,76),(382,1381,3,8)), 68 -> ((68,409,3,63),(68,713,2,69)), 786 -> ((786,183,4,270),(786,465,4,76)), 822 -> ((822,101,2,71),(822,235,3,200)), 140 -> ((140,873,2,68),(140,988,3,67)), 795 -> ((795,739,1,154),(795,1041,3,60)), 481 -> ((481,207,3,63),(481,1039,4,87)), 454 -> ((454,147,3,159),(454,1105,3,14)), 113 -> ((113,323,4,192),(113,325,4,104)), 149 -> ((149,323,2,192),(149,325,2,104)), 687 -> ((687,323,2,192),(687,895,4,96)), 660 -> ((660,739,2,154),(660,1411,2,28)), 346 -> ((346,147,4,159),(346,233,4,115)), 696 -> ((696,899,3,8),(696,1062,4,9)), 669 -> ((669,183,3,270),(669,205,4,128)), 355 -> ((355,681,4,24),(355,1429,4,3)), 768 -> ((768,405,4,303),(768,1061,1,24)), 735 -> ((735,147,1,159),(735,325,1,104)), 394 -> ((394,233,3,115),(394,739,4,154)), 708 -> ((708,147,4,159),(708,687,2,58)), 367 -> ((367,183,5,270),(367,551,3,22)), 53 -> ((53,15,5,255),(53,1087,4,10)), 403 -> ((403,147,5,159),(403,405,5,303)), 62 -> ((62,147,3,159),(62,155,1,96)), 134 -> ((134,15,5,255),(134,301,2,186)), 941 -> ((941,273,3,200),(941,763,3,138)), 600 -> ((600,233,2,115),(600,947,4,16)), 609 -> ((609,147,1,159),(609,877,5,42)), 681 -> ((681,1105,3,14),(681,1394,5,6)), 35 -> ((35,333,4,202),(35,937,4,32)), 376 -> ((376,223,4,124),(376,357,4,243)), 690 -> ((690,233,3,115),(690,739,3,154)), 349 -> ((349,325,3,104),(349,619,4,61)), 8 -> ((8,233,4,115),(8,687,1,58)), 699 -> ((699,147,2,159),(699,991,3,23)), 44 -> ((44,147,4,159),(44,155,3,96)), 762 -> ((762,749,1,44),(762,815,1,100)), 358 -> ((358,179,4,201),(358,1021,5,34)), 17 -> ((17,323,1,192),(17,475,4,222)), 430 -> ((430,101,2,71),(430,221,5,64)), 771 -> ((771,873,3,68),(771,949,5,65)), 26 -> ((26,323,2,192),(26,405,2,303)), 125 -> ((125,1249,3,12),(125,1271,2,7)), 672 -> ((672,15,3,255),(672,109,4,116)), 331 -> ((331,811,4,17),(331,947,5,16)), 645 -> ((645,521,4,115),(645,955,4,46)), 304 -> ((304,323,3,192),(304,895,3,96)), 654 -> ((654,147,3,159),(654,739,4,154)), 340 -> ((340,205,4,128),(340,969,5,72)), 421 -> ((421,183,5,270),(421,213,3,128)), 80 -> ((80,205,5,128),(80,213,3,128)), 89 -> ((89,739,2,154),(89,949,3,65)), 627 -> ((627,233,2,115),(627,521,2,115)), 286 -> ((286,147,5,159),(286,155,4,96)), 636 -> ((636,15,5,255),(636,235,4,200)), 295 -> ((295,155,4,96),(295,485,4,117)), 717 -> ((717,147,4,159),(717,405,3,303)), 923 -> ((923,1001,1,17),(923,1277,5,18)), 448 -> ((448,887,2,55),(448,900,3,35)), 457 -> ((457,147,5,159),(457,155,4,96)), 932 -> ((932,155,3,96),(932,521,5,115)), 116 -> ((116,47,3,124),(116,323,3,192)), 663 -> ((663,147,3,159),(663,521,3,115)), 744 -> ((744,301,3,186),(744,657,5,121)), 753 -> ((753,183,1,270),(753,657,5,121)), 412 -> ((412,357,4,243),(412,939,4,59)), 98 -> ((98,523,5,150),(98,659,5,107)), 439 -> ((439,147,4,159),(439,895,3,96)), 71 -> ((71,289,2,208),(71,357,5,243)), 107 -> ((107,323,1,192),(107,325,3,104)), 618 -> ((618,233,3,115),(618,521,2,115)), 313 -> ((313,147,4,159),(313,155,2,96)), 322 -> ((322,521,5,115),(322,655,5,218)), 726 -> ((726,323,3,192),(726,409,3,63)), 385 -> ((385,739,1,154),(385,1103,3,19)), 11 -> ((11,739,3,154),(11,745,5,14)), 908 -> ((908,147,2,159),(908,183,4,270)), 567 -> ((567,521,3,115),(567,1021,4,34)), 639 -> ((639,155,3,96),(639,739,3,154)), 648 -> ((648,377,3,11),(648,687,1,58)), 307 -> ((307,739,2,154),(307,1411,4,28)), 388 -> ((388,323,4,192),(388,895,4,96)), 74 -> ((74,137,3,155),(74,301,3,186)), 56 -> ((56,233,1,115),(56,323,3,192)), 397 -> ((397,991,1,23),(397,1001,1,17)), 935 -> ((935,405,4,303),(935,597,4,186)), 603 -> ((603,183,4,270),(603,227,3,148)), 262 -> ((262,147,3,159),(262,485,4,117)), 702 -> ((702,289,2,208),(702,895,1,96)), 298 -> ((298,485,3,117),(298,951,4,37)), 370 -> ((370,183,4,270),(370,323,2,192)), 711 -> ((711,155,4,96),(711,739,3,154)), 29 -> ((29,657,4,121),(29,1019,4,28)), 684 -> ((684,225,3,100),(684,395,2,52)), 343 -> ((343,147,4,159),(343,155,1,96)), 693 -> ((693,521,5,115),(693,611,4,39)), 38 -> ((38,155,5,96),(38,225,5,100)), 379 -> ((379,233,3,115),(379,405,3,303)), 352 -> ((352,183,5,270),(352,657,4,121)), 47 -> ((47,289,4,208),(47,301,4,186)), 576 -> ((576,323,3,192),(576,763,3,138)), 585 -> ((585,207,5,63),(585,1021,3,34)), 926 -> ((926,237,3,335),(926,313,3,278)), 244 -> ((244,155,3,96),(244,537,5,29)), 558 -> ((558,15,3,255),(558,137,4,155)), 899 -> ((899,147,2,159),(899,179,2,201)), 594 -> ((594,221,4,64),(594,357,4,243)), 253 -> ((253,485,5,117),(253,1039,4,87)), 226 -> ((226,179,4,201),(226,405,4,303)), 325 -> ((325,521,4,115),(325,1411,4,28)), 666 -> ((666,147,3,159),(666,205,3,128)), 361 -> ((361,155,3,96),(361,739,4,154)), 20 -> ((20,323,4,192),(20,357,1,243)), 334 -> ((334,155,2,96),(334,537,4,29)), 675 -> ((675,223,1,124),(675,463,5,67)), 2 -> ((2,289,3,208),(2,309,1,23)), 872 -> ((872,405,4,303),(872,409,3,63)), 881 -> ((881,233,3,115),(881,739,4,154)), 540 -> ((540,147,3,159),(540,323,3,192)), 549 -> ((549,323,2,192),(549,405,4,303)), 890 -> ((890,739,2,154),(890,1039,4,87)), 235 -> ((235,1105,2,14),(235,1119,3,53)), 621 -> ((621,233,3,115),(621,1093,4,21)), 657 -> ((657,109,1,116),(657,873,3,68)), 316 -> ((316,521,5,115),(316,1039,5,87)), 289 -> ((289,147,3,159),(289,405,2,303)), 630 -> ((630,687,3,58),(630,983,3,13)), 863 -> ((863,873,2,68),(863,1313,1,12)), 65 -> ((65,1041,3,60),(65,1129,4,25)), 917 -> ((917,405,3,303),(917,473,3,117)), 612 -> ((612,147,4,159),(612,477,2,87)), 271 -> ((271,739,4,154),(271,951,2,37)), 280 -> ((280,155,5,96),(280,233,4,115)), 5 -> ((5,377,1,11),(5,407,3,38)), 319 -> ((319,261,3,35),(319,301,4,186)), 516 -> ((516,357,3,243),(516,515,4,179)), 830 -> ((830,183,4,270),(830,205,5,128)), 857 -> ((857,547,3,36),(857,892,3,44)), 552 -> ((552,147,3,159),(552,873,3,68)), 866 -> ((866,303,4,109),(866,313,1,278)), 525 -> ((525,147,3,159),(525,405,4,303)), 184 -> ((184,155,3,96),(184,739,3,154)), 534 -> ((534,147,5,159),(534,687,5,58)), 938 -> ((938,873,3,68),(938,1283,3,17)), 597 -> ((597,323,3,192),(597,713,2,69)), 193 -> ((193,147,2,159),(193,155,4,96)), 606 -> ((606,537,2,29),(606,951,2,37)), 265 -> ((265,107,1,37),(265,323,3,192)), 301 -> ((301,155,1,96),(301,233,4,115)), 615 -> ((615,521,4,115),(615,949,3,65)), 812 -> ((812,873,4,68),(812,881,4,38)), 848 -> ((848,739,5,154),(848,1021,5,34)), 821 -> ((821,405,4,303),(821,495,5,54)), 480 -> ((480,485,4,117),(480,1121,4,19)), 175 -> ((175,147,3,159),(175,273,2,200)), 893 -> ((893,323,2,192),(893,531,4,119)), 256 -> ((256,147,4,159),(256,233,4,115)), 803 -> ((803,325,4,104),(803,339,3,38)), 337 -> ((337,67,4,98),(337,125,4,223)), 211 -> ((211,205,5,128),(211,357,2,243)), 624 -> ((624,147,4,159),(624,687,2,58)), 283 -> ((283,407,3,38),(283,409,4,63)), 633 -> ((633,147,4,159),(633,183,4,270)), 292 -> ((292,207,5,63),(292,1039,4,87)), 498 -> ((498,1103,4,19),(498,1161,3,11)), 839 -> ((839,323,4,192),(839,713,2,69)), 166 -> ((166,687,1,58),(166,751,4,150)), 507 -> ((507,405,5,303),(507,895,5,96)), 920 -> ((920,301,2,186),(920,333,4,202)), 579 -> ((579,183,4,270),(579,877,1,42)), 274 -> ((274,873,3,68),(274,877,3,42)), 588 -> ((588,155,5,96),(588,739,4,154)), 929 -> ((929,521,5,115),(929,589,5,40)), 247 -> ((247,181,4,439),(247,269,4,254)), 14 -> ((14,813,2,48),(14,921,5,42)), 328 -> ((328,155,4,96),(328,739,3,154)), 489 -> ((489,991,3,23),(489,1613,4,1)), 902 -> ((902,989,2,27),(902,1016,2,122)), 220 -> ((220,289,4,208),(220,995,3,24)), 561 -> ((561,155,2,96),(561,537,4,29)), 875 -> ((875,1103,5,19),(875,1422,3,4)), 911 -> ((911,183,4,270),(911,205,3,128)), 229 -> ((229,303,1,109),(229,937,2,32)), 884 -> ((884,949,2,65),(884,1073,4,62)), 570 -> ((570,289,1,208),(570,879,2,115)), 543 -> ((543,147,4,159),(543,233,4,115)), 202 -> ((202,179,1,201),(202,191,2,249)), 642 -> ((642,147,4,159),(642,155,3,96)), 238 -> ((238,405,4,303),(238,845,3,152)), 310 -> ((310,181,4,439),(310,251,5,41)), 651 -> ((651,309,1,23),(651,995,1,24)), 277 -> ((277,147,4,159),(277,619,4,61)), 815 -> ((815,233,3,115),(815,521,4,115)), 474 -> ((474,521,5,115),(474,789,4,45)), 824 -> ((824,687,2,58),(824,989,2,27)), 483 -> ((483,107,3,37),(483,405,3,303)), 142 -> ((142,147,1,159),(142,425,4,79)), 151 -> ((151,147,2,159),(151,485,5,117)), 896 -> ((896,147,2,159),(896,1249,2,12)), 492 -> ((492,521,5,115),(492,657,3,121)), 250 -> ((250,991,2,23),(250,1161,4,11)), 905 -> ((905,873,3,68),(905,1051,2,38)), 223 -> ((223,155,5,96),(223,873,3,68)), 564 -> ((564,323,3,192),(564,597,4,186)), 259 -> ((259,147,4,159),(259,179,4,201)), 232 -> ((232,133,4,160),(232,425,4,79)), 573 -> ((573,183,3,270),(573,205,3,128)), 770 -> ((770,323,5,192),(770,325,4,104)), 779 -> ((779,225,4,100),(779,235,4,200)), 438 -> ((438,619,4,61),(438,845,4,152)), 124 -> ((124,209,3,177),(124,474,3,177)), 537 -> ((537,147,2,159),(537,1105,1,14)), 878 -> ((878,155,3,96),(878,739,3,154)), 133 -> ((133,749,4,44),(133,902,3,37)), 447 -> ((447,147,4,159),(447,233,4,115)), 851 -> ((851,147,4,159),(851,1105,4,14)), 106 -> ((106,739,3,154),(106,1115,4,27)), 887 -> ((887,47,5,124),(887,183,1,270)), 546 -> ((546,717,5,76),(546,895,3,96)), 860 -> ((860,1041,2,60),(860,1059,1,32)), 205 -> ((205,875,2,39),(205,1025,1,38)), 519 -> ((519,991,2,23),(519,1295,5,5)), 214 -> ((214,179,5,201),(214,325,3,104)), 869 -> ((869,125,3,223),(869,1061,1,24)), 555 -> ((555,147,4,159),(555,405,4,303)), 528 -> ((528,213,4,128),(528,657,5,121)), 752 -> ((752,1105,3,14),(752,1527,1,5)), 761 -> ((761,205,4,128),(761,877,2,42)), 420 -> ((420,179,5,201),(420,301,3,186)), 833 -> ((833,233,2,115),(833,521,4,115)), 429 -> ((429,147,2,159),(429,155,2,96)), 743 -> ((743,289,3,208),(743,301,4,186)), 842 -> ((842,749,4,44),(842,1395,4,6)), 501 -> ((501,147,3,159),(501,405,4,303)), 160 -> ((160,55,4,136),(160,325,3,104)), 169 -> ((169,213,5,128),(169,495,3,54)), 510 -> ((510,873,3,68),(510,1025,3,38)), 178 -> ((178,147,4,159),(178,155,4,96)), 582 -> ((582,405,3,303),(582,473,3,117)), 591 -> ((591,47,3,124),(591,1041,2,60)), 456 -> ((456,739,3,154),(456,789,3,45)), 797 -> ((797,309,3,23),(797,1023,3,29)), 465 -> ((465,179,3,201),(465,395,1,52)), 806 -> ((806,155,3,96),(806,233,2,115)), 788 -> ((788,739,2,154),(788,983,3,13)), 115 -> ((115,183,5,270),(115,657,3,121)), 187 -> ((187,179,5,201),(187,1119,3,53)), 196 -> ((196,153,5,230),(196,845,4,152)), 914 -> ((914,739,2,154),(914,775,3,25)), 268 -> ((268,1249,2,12),(268,1273,2,14)), 241 -> ((241,335,3,17),(241,895,2,96)), 369 -> ((369,179,4,201),(369,335,2,17)), 441 -> ((441,313,4,278),(441,538,3,54)), 782 -> ((782,991,2,23),(782,1105,3,14)), 181 -> ((181,147,1,159),(181,991,1,23)), 809 -> ((809,333,3,202),(809,1025,1,38)), 163 -> ((163,433,1,160),(163,879,2,115)), 477 -> ((477,739,4,154),(477,1041,5,60)), 172 -> ((172,183,5,270),(172,425,1,79)), 513 -> ((513,739,5,154),(513,763,3,138)), 387 -> ((387,147,2,159),(387,233,3,115)), 46 -> ((46,125,4,223),(46,909,5,11)), 800 -> ((800,405,4,303),(800,751,4,150)), 459 -> ((459,147,3,159),(459,989,5,27)), 118 -> ((118,179,5,201),(118,223,5,124)), 432 -> ((432,405,4,303),(432,763,5,138)), 468 -> ((468,377,2,11),(468,955,4,46)), 127 -> ((127,271,5,180),(127,901,5,9)), 199 -> ((199,989,1,27),(199,1326,3,6)), 854 -> ((854,147,3,159),(854,537,3,29)), 136 -> ((136,223,4,124),(136,525,5,70)), 208 -> ((208,739,4,154),(208,781,3,72)), 217 -> ((217,147,3,159),(217,233,4,115)), 683 -> ((683,133,5,160),(683,323,3,192)), 414 -> ((414,325,3,104),(414,433,5,160)), 100 -> ((100,323,3,192),(100,887,2,55)), 728 -> ((728,323,3,192),(728,1355,4,5)), 755 -> ((755,323,4,192),(755,887,3,55)), 109 -> ((109,147,4,159),(109,233,4,115)), 450 -> ((450,155,4,96),(450,1249,3,12)), 764 -> ((764,323,3,192),(764,405,4,303)), 82 -> ((82,147,3,159),(82,1001,1,17)), 423 -> ((423,887,5,55),(423,1011,3,90)), 495 -> ((495,147,5,159),(495,155,3,96)), 836 -> ((836,657,5,121),(836,793,2,10)), 522 -> ((522,521,5,115),(522,543,4,21)), 91 -> ((91,183,5,270),(91,205,5,128)), 531 -> ((531,895,2,96),(531,908,1,17)), 190 -> ((190,989,3,27),(190,1313,2,12)), 504 -> ((504,155,3,96),(504,537,3,29)), 845 -> ((845,909,4,11),(845,1399,3,6)), 396 -> ((396,323,4,192),(396,619,3,61)), 737 -> ((737,137,5,155),(737,357,5,243)), 55 -> ((55,273,5,200),(55,597,2,186)), 710 -> ((710,179,4,201),(710,1039,4,87)), 405 -> ((405,377,1,11),(405,537,1,29)), 64 -> ((64,183,5,270),(64,405,3,303)), 746 -> ((746,233,4,115),(746,405,2,303)), 719 -> ((719,289,2,208),(719,655,4,218)), 378 -> ((378,155,4,96),(378,233,2,115)), 818 -> ((818,303,5,109),(818,875,1,39)), 73 -> ((73,183,4,270),(73,213,4,128)), 791 -> ((791,301,3,186),(791,331,1,88)), 486 -> ((486,1093,4,21),(486,1589,3,4)), 827 -> ((827,289,3,208),(827,333,3,202)), 145 -> ((145,155,2,96),(145,739,2,154)), 154 -> ((154,191,4,249),(154,945,3,39)), 692 -> ((692,523,3,150),(692,763,3,138)), 360 -> ((360,521,5,115),(360,1039,5,87)), 701 -> ((701,289,4,208),(701,303,4,109)), 773 -> ((773,233,1,115),(773,1021,5,34)), 426 -> ((426,205,4,128),(426,617,3,17)), 85 -> ((85,521,3,115),(85,1103,3,19)), 740 -> ((740,873,2,68),(740,1038,4,12)), 399 -> ((399,147,5,159),(399,155,2,96)), 58 -> ((58,1105,2,14),(58,1106,4,4)), 94 -> ((94,155,2,96),(94,537,4,29)), 67 -> ((67,125,4,223),(67,235,3,200)), 408 -> ((408,313,4,278),(408,539,1,38)), 139 -> ((139,297,5,39),(139,1233,5,6)), 300 -> ((300,687,2,58),(300,881,5,38)), 686 -> ((686,521,5,115),(686,527,3,179)), 623 -> ((623,183,3,270),(623,227,4,148)), 722 -> ((722,405,3,303),(722,823,3,73)), 381 -> ((381,485,4,117),(381,1119,4,53)), 354 -> ((354,155,2,96),(354,485,4,117)), 40 -> ((40,879,2,115),(40,1038,1,12)), 695 -> ((695,989,3,27),(695,991,5,23)), 704 -> ((704,657,4,121),(704,1299,3,8)), 390 -> ((390,289,3,208),(390,845,2,152)), 49 -> ((49,147,1,159),(49,179,5,201)), 471 -> ((471,465,5,76),(471,1219,4,18)), 130 -> ((130,147,4,159),(130,233,4,115)), 937 -> ((937,225,2,100),(937,295,4,70)), 336 -> ((336,1249,3,12),(336,1437,2,9)), 677 -> ((677,687,4,58),(677,1011,3,90)), 345 -> ((345,739,4,154),(345,949,3,65)), 4 -> ((4,301,5,186),(4,329,5,37)), 13 -> ((13,147,3,159),(13,155,2,96)), 767 -> ((767,183,4,270),(767,657,4,121)), 632 -> ((632,233,3,115),(632,739,3,154)), 641 -> ((641,1039,4,87),(641,1194,3,29)), 713 -> ((713,345,3,55),(713,347,4,110)), 372 -> ((372,325,4,104),(372,1273,4,14)), 794 -> ((794,109,4,116),(794,1251,4,8)), 453 -> ((453,233,2,115),(453,1273,2,14)), 148 -> ((148,521,1,115),(148,1039,2,87)), 462 -> ((462,323,2,192),(462,873,4,68)), 121 -> ((121,125,2,223),(121,717,5,76)), 157 -> ((157,147,5,159),(157,407,4,38)), 668 -> ((668,323,4,192),(668,895,3,96)), 22 -> ((22,233,3,115),(22,1001,1,17)), 363 -> ((363,155,2,96),(363,537,1,29)), 435 -> ((435,155,3,96),(435,1103,4,19)), 776 -> ((776,179,4,201),(776,947,2,16)), 31 -> ((31,1021,3,34),(31,1022,5,29)), 749 -> ((749,155,2,96),(749,233,5,115)), 758 -> ((758,147,4,159),(758,155,1,96)), 444 -> ((444,307,3,155),(444,313,4,278)), 103 -> ((103,405,3,303),(103,1089,1,35)), 785 -> ((785,137,2,155),(785,995,3,24)), 76 -> ((76,325,2,104),(76,955,4,46)), 417 -> ((417,537,4,29),(417,1041,3,60)), 112 -> ((112,323,3,192),(112,325,1,104)), 650 -> ((650,155,2,96),(650,233,2,115)), 309 -> ((309,989,3,27),(309,1025,5,38)), 659 -> ((659,155,3,96),(659,739,4,154)), 318 -> ((318,739,5,154),(318,1063,3,35)), 731 -> ((731,521,1,115),(731,1275,1,4)), 327 -> ((327,147,2,159),(327,537,4,29)), 698 -> ((698,485,4,117),(698,1021,1,34)), 16 -> ((16,155,3,96),(16,233,5,115)), 357 -> ((357,147,5,159),(357,687,3,58)), 97 -> ((97,183,5,270),(97,205,2,128)), 563 -> ((563,153,4,230),(563,167,4,65)), 653 -> ((653,233,3,115),(653,739,3,154)), 312 -> ((312,537,5,29),(312,1021,3,34)), 348 -> ((348,107,4,37),(348,323,5,192)), 7 -> ((7,537,3,29),(7,619,3,61)), 734 -> ((734,485,5,117),(734,705,4,128)), 79 -> ((79,325,5,104),(79,813,5,48)), 393 -> ((393,147,5,159),(393,377,3,11)), 88 -> ((88,319,3,139),(88,1191,5,3)), 402 -> ((402,15,5,255),(402,137,4,155)), 626 -> ((626,323,1,192),(626,681,1,24)), 940 -> ((940,147,4,159),(940,521,4,115)), 294 -> ((294,147,4,159),(294,323,3,192)), 608 -> ((608,207,5,63),(608,1039,5,87)), 635 -> ((635,323,3,192),(635,877,3,42)), 644 -> ((644,873,4,68),(644,1025,4,38)), 707 -> ((707,155,3,96),(707,739,2,154)), 303 -> ((303,147,4,159),(303,155,3,96)), 716 -> ((716,521,3,115),(716,949,3,65)), 375 -> ((375,233,4,115),(375,525,4,70)), 725 -> ((725,873,4,68),(725,881,5,38)), 70 -> ((70,739,2,154),(70,993,3,59)), 384 -> ((384,289,5,208),(384,333,4,202)), 411 -> ((411,485,4,117),(411,655,4,218)), 43 -> ((43,155,4,96),(43,951,3,37)), 52 -> ((52,107,4,37),(52,657,5,121)), 922 -> ((922,155,2,96),(922,739,3,154)), 276 -> ((276,147,4,159),(276,233,3,115)), 931 -> ((931,459,4,23),(931,909,5,11)), 904 -> ((904,155,4,96),(904,1041,2,60)), 590 -> ((590,125,3,223),(590,137,5,155)), 249 -> ((249,147,5,159),(249,1103,5,19)), 285 -> ((285,183,4,270),(285,205,4,128)), 258 -> ((258,289,2,208),(258,877,3,42)), 599 -> ((599,1277,4,18),(599,1357,2,2)), 671 -> ((671,147,1,159),(671,405,3,303)), 330 -> ((330,739,5,154),(330,989,5,27)), 267 -> ((267,147,3,159),(267,155,3,96)), 25 -> ((25,183,4,270),(25,837,4,25)), 339 -> ((339,233,1,115),(339,739,3,154)), 366 -> ((366,413,4,51),(366,561,5,57)), 680 -> ((680,15,3,255),(680,137,4,155)), 34 -> ((34,991,4,23),(34,1024,5,13)), 913 -> ((913,183,4,270),(913,465,2,76)), 886 -> ((886,1093,1,21),(886,1119,4,53)), 572 -> ((572,813,4,48),(572,924,1,77)), 240 -> ((240,873,2,68),(240,895,5,96)), 581 -> ((581,137,5,155),(581,1367,5,4)), 895 -> ((895,283,4,159),(895,885,2,12)), 662 -> ((662,13,4,164),(662,1381,5,8)), 321 -> ((321,485,4,117),(321,657,4,121)), 877 -> ((877,155,2,96),(877,739,4,154)), 61 -> ((61,301,1,186),(61,333,3,202)), 617 -> ((617,183,4,270),(617,1021,4,34)), 689 -> ((689,405,5,303),(689,717,3,76)), 10 -> ((10,155,4,96),(10,521,4,115)), 521 -> ((521,147,4,159),(521,183,3,270)), 862 -> ((862,147,5,159),(862,521,5,115)), 557 -> ((557,739,3,154),(557,887,3,55)), 871 -> ((871,147,5,159),(871,989,3,27)), 530 -> ((530,183,4,270),(530,191,5,249)), 189 -> ((189,207,5,63),(189,485,4,117)), 225 -> ((225,705,5,128),(225,1203,5,21)), 943 -> ((943,233,5,115),(943,739,4,154)), 306 -> ((306,1251,5,8),(306,1514,4,7)), 817 -> ((817,405,3,303),(817,597,2,186)), 853 -> ((853,323,3,192),(853,877,2,42)), 512 -> ((512,183,5,270),(512,325,2,104)), 37 -> ((37,147,3,159),(37,233,4,115)), 180 -> ((180,739,3,154),(180,1131,5,12)), 665 -> ((665,147,4,159),(665,687,2,58)), 674 -> ((674,323,3,192),(674,763,5,138)), 333 -> ((333,153,4,230),(333,873,3,68)), 342 -> ((342,1103,3,19),(342,1163,3,24)), 1 -> ((1,147,3,159),(1,233,2,115)), 889 -> ((889,147,3,159),(889,155,3,96)), 207 -> ((207,233,3,115),(207,521,4,115)), 548 -> ((548,147,5,159),(548,991,1,23)), 216 -> ((216,147,4,159),(216,789,5,45)), 288 -> ((288,205,5,128),(288,887,5,55)), 629 -> ((629,147,5,159),(629,991,1,23)), 324 -> ((324,873,5,68),(324,877,1,42)), 638 -> ((638,405,3,303),(638,523,4,150)), 297 -> ((297,147,3,159),(297,485,3,117)), 844 -> ((844,207,4,63),(844,1039,4,87)), 503 -> ((503,233,5,115),(503,739,1,154)), 198 -> ((198,183,5,270),(198,323,2,192)), 539 -> ((539,155,4,96),(539,289,4,208)), 611 -> ((611,873,3,68),(611,887,2,55)), 270 -> ((270,155,5,96),(270,739,4,154)), 584 -> ((584,227,4,148),(584,431,3,146)), 925 -> ((925,325,4,104),(925,563,2,29)), 934 -> ((934,183,2,270),(934,949,3,65)), 620 -> ((620,147,3,159),(620,951,3,37)), 279 -> ((279,147,4,159),(279,233,5,115)), 593 -> ((593,155,5,96),(593,233,2,115)), 252 -> ((252,149,5,23),(252,847,4,47)), 351 -> ((351,989,4,27),(351,990,5,30)), 19 -> ((19,325,4,104),(19,887,4,55)), 826 -> ((826,233,4,115),(826,625,3,77)), 28 -> ((28,323,3,192),(28,859,3,14)), 898 -> ((898,309,5,23),(898,313,4,278)), 835 -> ((835,485,5,117),(835,1045,4,25)), 566 -> ((566,155,2,96),(566,521,4,115)), 907 -> ((907,147,5,159),(907,739,5,154)), 880 -> ((880,147,4,159),(880,233,4,115)), 602 -> ((602,261,3,35),(602,895,3,96)), 261 -> ((261,687,5,58),(261,1237,3,5)), 575 -> ((575,357,5,243),(575,531,1,119)), 234 -> ((234,147,3,159),(234,233,2,115)), 916 -> ((916,147,1,159),(916,155,2,96)), 647 -> ((647,147,4,159),(647,1263,3,13)), 243 -> ((243,713,3,69),(243,813,4,48)), 656 -> ((656,301,3,186),(656,903,2,15)), 315 -> ((315,183,3,270),(315,223,5,124)), 282 -> ((282,333,3,202),(282,879,2,115)), 820 -> ((820,333,5,202),(820,895,2,96)), 174 -> ((174,147,4,159),(174,155,4,96)), 829 -> ((829,213,4,128),(829,1193,4,9)), 147 -> ((147,301,5,186),(147,937,3,32)), 488 -> ((488,521,3,115),(488,873,3,68)), 928 -> ((928,191,5,249),(928,749,5,44)), 183 -> ((183,739,4,154),(183,1159,3,11)), 901 -> ((901,155,5,96),(901,739,5,154)), 497 -> ((497,155,3,96),(497,233,2,115)), 587 -> ((587,989,2,27),(587,1625,4,1)), 156 -> ((156,157,4,121),(156,655,3,218)), 596 -> ((596,289,3,208),(596,295,4,70)), 910 -> ((910,183,4,270),(910,205,4,128)), 255 -> ((255,147,4,159),(255,323,2,192)), 569 -> ((569,325,1,104),(569,405,3,303)), 228 -> ((228,137,1,155),(228,327,1,150)), 578 -> ((578,325,1,104),(578,751,3,150)), 264 -> ((264,1103,5,19),(264,1475,2,8)), 461 -> ((461,319,3,139),(461,575,2,44)), 802 -> ((802,687,3,58),(802,1025,3,38)), 775 -> ((775,887,4,55),(775,900,3,35)), 811 -> ((811,895,5,96),(811,901,4,9)), 784 -> ((784,323,4,192),(784,877,4,42)), 470 -> ((470,125,4,223),(470,1067,4,38)), 129 -> ((129,323,1,192),(129,903,2,15)), 443 -> ((443,309,5,23),(443,333,5,202)), 883 -> ((883,147,2,159),(883,739,2,154)), 479 -> ((479,147,3,159),(479,739,1,154)), 138 -> ((138,147,4,159),(138,617,4,17)), 542 -> ((542,47,5,124),(542,179,4,201)), 452 -> ((452,521,3,115),(452,947,5,16)), 551 -> ((551,147,4,159),(551,155,4,96)), 892 -> ((892,155,2,96),(892,233,5,115)), 210 -> ((210,205,4,128),(210,465,4,76)), 560 -> ((560,183,5,270),(560,1021,4,34)), 219 -> ((219,223,5,124),(219,433,5,160)), 291 -> ((291,147,4,159),(291,155,3,96)), 757 -> ((757,155,2,96),(757,233,3,115)), 766 -> ((766,739,2,154),(766,951,3,37)), 838 -> ((838,179,5,201),(838,1039,5,87)), 120 -> ((120,125,4,223),(120,237,3,335)), 847 -> ((847,485,3,117),(847,609,2,56)), 506 -> ((506,147,3,159),(506,233,4,115)), 165 -> ((165,223,4,124),(165,1119,3,53)), 856 -> ((856,289,1,208),(856,307,4,155)), 515 -> ((515,687,3,58),(515,895,4,96)), 237 -> ((237,485,4,117),(237,525,4,70)), 246 -> ((246,155,1,96),(246,739,2,154)), 793 -> ((793,405,3,303),(793,823,3,73)), 865 -> ((865,405,2,303),(865,625,1,77)), 524 -> ((524,739,2,154),(524,1093,4,21)), 874 -> ((874,521,5,115),(874,751,3,150)), 192 -> ((192,125,3,223),(192,289,4,208)), 533 -> ((533,147,1,159),(533,739,5,154)), 605 -> ((605,521,5,115),(605,873,3,68)), 201 -> ((201,537,3,29),(201,991,4,23)), 919 -> ((919,147,4,159),(919,989,2,27)), 614 -> ((614,147,5,159),(614,405,2,303)), 273 -> ((273,307,2,155),(273,313,3,278)), 60 -> ((60,207,3,63),(60,485,4,117)), 859 -> ((859,955,5,46),(859,1281,3,11)), 213 -> ((213,521,4,115),(213,655,4,218)), 186 -> ((186,147,4,159),(186,225,4,100)), 222 -> ((222,147,4,159),(222,155,4,96)), 87 -> ((87,233,4,115),(87,521,3,115)), 437 -> ((437,155,3,96),(437,739,3,154)), 96 -> ((96,183,4,270),(96,525,2,70)), 850 -> ((850,485,5,117),(850,705,5,128)), 509 -> ((509,289,2,208),(509,309,2,23)), 168 -> ((168,323,3,192),(168,325,1,104)), 482 -> ((482,243,2,111),(482,881,3,38)), 518 -> ((518,147,4,159),(518,619,4,61)), 177 -> ((177,47,3,124),(177,183,4,270)), 715 -> ((715,155,4,96),(715,233,3,115)), 724 -> ((724,1105,1,14),(724,1591,1,5)), 383 -> ((383,205,4,128),(383,213,5,128)), 796 -> ((796,147,5,159),(796,155,5,96)), 392 -> ((392,873,3,68),(392,875,3,39)), 733 -> ((733,107,4,37),(733,619,3,61)), 805 -> ((805,147,5,159),(805,155,1,96)), 464 -> ((464,295,5,70),(464,301,4,186)), 150 -> ((150,147,4,159),(150,235,4,200)), 500 -> ((500,147,3,159),(500,739,2,154)), 132 -> ((132,521,4,115),(132,1019,3,28)), 814 -> ((814,669,3,12),(814,675,3,52)), 159 -> ((159,873,2,68),(159,877,3,42)), 473 -> ((473,137,4,155),(473,1007,4,43)), 545 -> ((545,155,3,96),(545,233,4,115)), 141 -> ((141,147,4,159),(141,407,2,38)), 554 -> ((554,1041,3,60),(554,1284,3,24)), 778 -> ((778,405,3,303),(778,623,1,35)), 787 -> ((787,877,2,42),(787,937,3,32)), 105 -> ((105,313,5,278),(105,751,2,150)), 760 -> ((760,739,4,154),(760,873,4,68)), 446 -> ((446,289,3,208),(446,887,4,55)), 419 -> ((419,405,3,303),(419,617,4,17)), 455 -> ((455,147,4,159),(455,183,4,270)), 428 -> ((428,323,3,192),(428,1313,4,12)), 114 -> ((114,485,3,117),(114,655,3,218)), 769 -> ((769,1093,3,21),(769,1312,2,7)), 841 -> ((841,873,4,68),(841,1294,5,4)), 868 -> ((868,155,2,96),(868,233,2,115)), 527 -> ((527,207,4,63),(527,1333,3,5)), 123 -> ((123,485,5,117),(123,657,4,121)), 536 -> ((536,183,3,270),(536,205,5,128)), 195 -> ((195,47,5,124),(195,55,4,136)), 204 -> ((204,297,5,39),(204,301,4,186)), 742 -> ((742,15,4,255),(742,237,4,335)), 401 -> ((401,147,2,159),(401,537,4,29)), 410 -> ((410,873,4,68),(410,905,4,23)), 751 -> ((751,537,4,29),(751,739,3,154)), 69 -> ((69,147,3,159),(69,289,4,208)), 823 -> ((823,155,3,96),(823,233,4,115)), 78 -> ((78,813,2,48),(78,871,3,70)), 832 -> ((832,873,2,68),(832,895,2,96)), 491 -> ((491,325,1,104),(491,513,5,69)), 697 -> ((697,989,2,27),(697,1067,5,38)), 231 -> ((231,289,4,208),(231,597,3,186)), 706 -> ((706,687,1,58),(706,756,4,109)), 332 -> ((332,147,4,159),(332,983,2,13)), 772 -> ((772,323,4,192),(772,1025,3,38)), 431 -> ((431,303,4,109),(431,689,3,68)), 745 -> ((745,207,2,63),(745,531,3,119)), 90 -> ((90,155,5,96),(90,739,5,154)), 404 -> ((404,739,4,154),(404,901,2,9)), 63 -> ((63,323,1,192),(63,325,2,104)), 99 -> ((99,147,5,159),(99,619,4,61)), 646 -> ((646,323,3,192),(646,1313,3,12)), 727 -> ((727,147,3,159),(727,155,3,96)), 45 -> ((45,1001,3,17),(45,1059,2,32)), 386 -> ((386,323,4,192),(386,405,4,303)), 395 -> ((395,739,3,154),(395,866,3,112)), 54 -> ((54,147,5,159),(54,325,3,104)), 808 -> ((808,751,3,150),(808,875,4,39)), 682 -> ((682,147,1,159),(682,991,2,23)), 341 -> ((341,881,5,38),(341,895,4,96)), 691 -> ((691,205,5,128),(691,227,4,148)), 422 -> ((422,323,3,192),(422,717,3,76)), 763 -> ((763,47,3,124),(763,133,3,160)), 171 -> ((171,887,4,55),(171,906,3,17)), 377 -> ((377,895,3,96),(377,1105,3,14)), 718 -> ((718,405,5,303),(718,717,4,76)), 413 -> ((413,147,2,159),(413,877,3,42)), 72 -> ((72,147,5,159),(72,233,4,115)), 485 -> ((485,301,2,186),(485,889,5,11)), 144 -> ((144,147,3,159),(144,521,4,115)), 799 -> ((799,289,3,208),(799,1063,4,35)), 81 -> ((81,147,4,159),(81,619,3,61)), 494 -> ((494,323,3,192),(494,357,5,243)), 153 -> ((153,325,2,104),(153,357,5,243)), 126 -> ((126,289,3,208),(126,681,5,24)), 467 -> ((467,273,4,200),(467,1059,4,32)), 162 -> ((162,147,4,159),(162,179,3,201)), 700 -> ((700,73,3,120),(700,169,3,107)), 359 -> ((359,323,3,192),(359,405,3,303)), 673 -> ((673,323,2,192),(673,895,3,96)), 709 -> ((709,155,2,96),(709,233,3,115)), 368 -> ((368,183,5,270),(368,413,1,51)), 27 -> ((27,325,2,104),(27,515,4,179)), 781 -> ((781,179,5,201),(781,289,3,208)), 440 -> ((440,1105,5,14),(440,1591,5,5)), 754 -> ((754,459,4,23),(754,477,5,87)), 36 -> ((36,873,3,68),(36,875,3,39)), 476 -> ((476,47,3,124),(476,325,1,104)), 790 -> ((790,155,3,96),(790,233,3,115)), 449 -> ((449,983,2,13),(449,1367,4,4)), 135 -> ((135,183,4,270),(135,325,4,104)), 108 -> ((108,405,3,303),(108,515,5,179)), 458 -> ((458,147,2,159),(458,521,4,115)), 117 -> ((117,179,5,201),(117,789,4,45)), 655 -> ((655,155,4,96),(655,537,3,29)), 350 -> ((350,183,3,270),(350,1039,4,87)), 323 -> ((323,873,3,68),(323,875,3,39)), 664 -> ((664,47,4,124),(664,183,3,270)), 9 -> ((9,385,5,195),(9,615,4,49)), 18 -> ((18,739,3,154),(18,951,3,37)), 736 -> ((736,323,1,192),(736,1089,1,35)), 389 -> ((389,155,2,96),(389,739,2,154)), 362 -> ((362,879,5,115),(362,1025,2,38)), 48 -> ((48,183,5,270),(48,323,3,192)), 703 -> ((703,323,2,192),(703,845,4,152)), 21 -> ((21,991,2,23),(21,995,2,24)), 57 -> ((57,1093,3,21),(57,1095,2,25)), 909 -> ((909,261,5,35),(909,289,3,208)), 263 -> ((263,521,3,115),(263,523,5,150)), 676 -> ((676,687,1,58),(676,895,1,96)), 272 -> ((272,521,5,115),(272,651,4,160)), 344 -> ((344,537,4,29),(344,619,4,61)), 685 -> ((685,289,2,208),(685,875,3,39)), 317 -> ((317,313,4,278),(317,879,3,115)), 658 -> ((658,55,4,136),(658,235,2,200)), 3 -> ((3,325,1,104),(3,341,1,9)), 353 -> ((353,301,3,186),(353,333,4,202)), 12 -> ((12,133,4,160),(12,157,5,121)), 425 -> ((425,147,3,159),(425,233,2,115)), 84 -> ((84,225,4,100),(84,317,3,94)), 434 -> ((434,147,3,159),(434,225,4,100)), 93 -> ((93,125,1,223),(93,283,4,159)), 900 -> ((900,205,4,128),(900,325,1,104)), 102 -> ((102,233,3,115),(102,947,3,16)), 631 -> ((631,873,2,68),(631,877,2,42)), 640 -> ((640,233,4,115),(640,1067,4,38)), 326 -> ((326,233,4,115),(326,521,2,115)), 299 -> ((299,739,3,154),(299,1103,4,19)), 335 -> ((335,323,4,192),(335,355,3,33)), 308 -> ((308,147,3,159),(308,537,4,29)), 649 -> ((649,181,4,439),(649,471,5,195)), 380 -> ((380,521,2,115),(380,1039,3,87)), 721 -> ((721,991,3,23),(721,1039,5,87)), 75 -> ((75,1001,1,17),(75,1059,1,32)), 730 -> ((730,873,2,68),(730,875,2,39)), 416 -> ((416,147,5,159),(416,155,5,96)), 927 -> ((927,155,4,96),(927,739,3,154)), 622 -> ((622,233,4,115),(622,739,2,154)), 281 -> ((281,323,3,192),(281,333,3,202)), 936 -> ((936,927,4,6),(936,1323,4,3)), 595 -> ((595,325,3,104),(595,717,2,76)), 290 -> ((290,739,3,154),(290,1091,2,39)), 604 -> ((604,447,4,115),(604,567,5,33)), 371 -> ((371,183,5,270),(371,655,4,218)), 30 -> ((30,873,1,68),(30,1013,3,38)), 712 -> ((712,739,4,154),(712,949,4,65)), 39 -> ((39,301,3,186),(39,937,5,32)), 918 -> ((918,485,3,117),(918,971,4,30)), 586 -> ((586,155,3,96),(586,1249,3,12)), 111 -> ((111,333,4,202),(111,354,4,60)), 667 -> ((667,137,3,155),(667,357,5,243)), 739 -> ((739,55,1,136),(739,465,1,76)), 398 -> ((398,991,2,23),(398,1041,3,60)), 407 -> ((407,147,4,159),(407,739,3,154)), 66 -> ((66,405,3,303),(66,763,4,138)), 748 -> ((748,183,4,270),(748,323,4,192)), 613 -> ((613,297,5,39),(613,607,4,63)), 694 -> ((694,521,3,115),(694,1455,3,2)), 356 -> ((356,331,3,88),(356,347,4,110)), 15 -> ((15,927,4,6),(15,937,4,32)), 867 -> ((867,207,5,63),(867,323,3,192)), 903 -> ((903,147,3,159),(903,521,5,115)), 562 -> ((562,485,5,117),(562,1039,4,87)), 230 -> ((230,233,1,115),(230,739,5,154)), 858 -> ((858,323,2,192),(858,333,4,202)), 42 -> ((42,521,2,115),(42,1041,4,60)), 51 -> ((51,655,3,218),(51,705,1,128)), 939 -> ((939,405,4,303),(939,1051,5,38)), 598 -> ((598,243,2,111),(598,895,2,96)), 257 -> ((257,949,3,65),(257,1137,5,27)), 24 -> ((24,55,5,136),(24,289,3,208)), 679 -> ((679,153,2,230),(679,223,5,124)), 338 -> ((338,133,4,160),(338,213,5,128)), 688 -> ((688,877,5,42),(688,879,5,115)), 374 -> ((374,147,3,159),(374,233,3,115)), 347 -> ((347,147,4,159),(347,233,5,115)), 33 -> ((33,323,4,192),(33,329,4,37)), 6 -> ((6,537,4,29),(6,539,2,38)), 885 -> ((885,233,3,115),(885,739,4,154)), 894 -> ((894,147,3,159),(894,179,5,201)), 553 -> ((553,485,3,117),(553,1021,2,34)), 248 -> ((248,183,5,270),(248,323,1,192)), 652 -> ((652,125,2,223),(652,333,4,202)), 589 -> ((589,873,5,68),(589,877,4,42)), 221 -> ((221,485,2,117),(221,789,4,45)), 661 -> ((661,179,4,201),(661,425,4,79)), 634 -> ((634,147,2,159),(634,991,3,23)), 320 -> ((320,147,4,159),(320,233,4,115)), 670 -> ((670,521,4,115),(670,949,2,65)), 302 -> ((302,289,3,208),(302,301,4,186)), 329 -> ((329,147,3,159),(329,323,2,192)), 643 -> ((643,147,3,159),(643,155,2,96)), 876 -> ((876,523,5,150),(876,531,4,119)), 535 -> ((535,521,5,115),(535,1039,4,87)), 849 -> ((849,207,5,63),(849,625,5,77)), 544 -> ((544,301,2,186),(544,877,2,42)), 203 -> ((203,323,3,192),(203,619,3,61)), 212 -> ((212,317,5,94),(212,645,3,26)), 930 -> ((930,107,3,37),(930,405,3,303)), 616 -> ((616,873,3,68),(616,895,3,96)), 275 -> ((275,183,3,270),(275,625,2,77)), 625 -> ((625,183,3,270),(625,405,3,303)), 311 -> ((311,233,4,115),(311,739,4,154)), 284 -> ((284,687,3,58),(284,877,2,42)), 293 -> ((293,147,2,159),(293,155,2,96)), 365 -> ((365,125,3,223),(365,289,3,208)), 526 -> ((526,323,2,192),(526,325,3,104)), 840 -> ((840,521,5,115),(840,949,4,65)), 912 -> ((912,611,3,39),(912,655,5,218)), 571 -> ((571,191,4,249),(571,1039,3,87)), 607 -> ((607,485,3,117),(607,887,3,55)), 266 -> ((266,325,1,104),(266,924,2,77)), 580 -> ((580,147,3,159),(580,687,3,58)), 921 -> ((921,147,3,159),(921,323,4,192)), 239 -> ((239,207,5,63),(239,745,5,14)), 314 -> ((314,147,4,159),(314,155,5,96)), 628 -> ((628,301,4,186),(628,333,5,202)), 852 -> ((852,407,3,38),(852,681,4,24)), 825 -> ((825,147,5,159),(825,687,5,58)), 511 -> ((511,887,5,55),(511,1527,4,5)), 520 -> ((520,893,2,11),(520,898,5,48)), 861 -> ((861,179,1,201),(861,213,5,128)), 493 -> ((493,687,1,58),(493,693,4,86)), 179 -> ((179,917,3,7),(179,1127,1,7)), 834 -> ((834,323,2,192),(834,405,4,303)), 152 -> ((152,155,5,96),(152,739,5,154)), 906 -> ((906,991,3,23),(906,1011,4,90)), 188 -> ((188,233,3,115),(188,485,3,117)), 592 -> ((592,147,4,159),(592,521,5,115)), 933 -> ((933,233,2,115),(933,765,1,31)), 502 -> ((502,687,4,58),(502,895,4,96)), 942 -> ((942,183,3,270),(942,945,5,39)), 260 -> ((260,881,4,38),(260,891,5,6)), 601 -> ((601,47,3,124),(601,183,4,270)), 610 -> ((610,485,5,117),(610,705,3,128)), 269 -> ((269,537,5,29),(269,739,1,154)), 807 -> ((807,739,4,154),(807,1039,4,87)), 475 -> ((475,303,1,109),(475,539,3,38)), 816 -> ((816,687,2,58),(816,1025,4,38)), 170 -> ((170,687,3,58),(170,876,3,42)), 484 -> ((484,233,5,115),(484,951,1,37)), 888 -> ((888,153,4,230),(888,191,5,249)), 143 -> ((143,307,4,155),(143,315,4,132)), 897 -> ((897,521,5,115),(897,951,3,37)), 556 -> ((556,133,5,160),(556,323,2,192)), 215 -> ((215,183,5,270),(215,205,3,128)), 565 -> ((565,207,4,63),(565,213,4,128)), 798 -> ((798,155,3,96),(798,377,3,11)), 466 -> ((466,183,3,270),(466,873,2,68)), 780 -> ((780,485,4,117),(780,657,3,121)), 547 -> ((547,289,3,208),(547,345,5,55)), 287 -> ((287,235,4,200),(287,1067,2,38)), 843 -> ((843,739,2,154),(843,1039,3,87)), 161 -> ((161,133,2,160),(161,225,1,100)), 574 -> ((574,213,4,128),(574,887,4,55)), 915 -> ((915,301,2,186),(915,345,4,55)), 583 -> ((583,55,4,136),(583,425,5,79)), 924 -> ((924,205,4,128),(924,433,5,160)), 242 -> ((242,111,4,245),(242,283,4,159)), 251 -> ((251,147,3,159),(251,183,5,270)), 789 -> ((789,137,2,155),(789,1007,4,43)), 870 -> ((870,47,3,124),(870,1041,2,60)), 529 -> ((529,309,3,23),(529,991,1,23)), 879 -> ((879,125,5,223),(879,597,2,186)), 224 -> ((224,147,3,159),(224,991,1,23)), 538 -> ((538,183,4,270),(538,213,3,128)), 197 -> ((197,233,4,115),(197,323,3,192)), 233 -> ((233,521,5,115),(233,523,4,150)), 296 -> ((296,521,4,115),(296,1251,5,8)), 637 -> ((637,147,1,159),(637,873,1,68)), 206 -> ((206,873,3,68),(206,1313,1,12)), 619 -> ((619,233,4,115),(619,323,3,192)), 305 -> ((305,207,5,63),(305,485,2,117)), 278 -> ((278,515,5,179),(278,923,5,54)))
   * 将重复评价数据过滤掉
   */
  val vectorCalcs =
    ratingPairs
      .map(data => {
        val key = (data._2._1._2, data._2._2._2)
        val stats =
          (data._2._1._3 * data._2._2._3, // rating 1 * rating 2
            data._2._1._3, // rating movie 1
            data._2._2._3, // rating movie 2
            math.pow(data._2._1._3, 2), // square of rating movie 1
            math.pow(data._2._2._3, 2), // square of rating movie 2
            data._2._1._4, // number of raters movie 1
            data._2._2._4) // number of raters movie 2
        (key, stats)
      })
      .groupByKey()
      .map(data => {
        val key = data._1
        val vals = data._2
        val size = vals.size
        val dotProduct = vals.map(f => f._1).sum
        val ratingSum = vals.map(f => f._2).sum
        val rating2Sum = vals.map(f => f._3).sum
        val ratingSq = vals.map(f => f._4).sum
        val rating2Sq = vals.map(f => f._5).sum
        val numRaters = vals.map(f => f._6).max
        val numRaters2 = vals.map(f => f._7).max
        (key, (size, dotProduct, ratingSum, rating2Sum, ratingSq, rating2Sq, numRaters, numRaters2))
      })
  //计算完原始输入数据后,开始计算每个电影的相似度
  val PRIOR_COUNT = 10
  val PRIOR_CORRELATION = 0
  //超参
  val similarities =
    vectorCalcs
      .map(fields => {
        val key = fields._1
        val (size, dotProduct, ratingSum, rating2Sum, ratingNormSq, rating2NormSq, numRaters, numRaters2) = fields._2
        val corr = correlation(size, dotProduct, ratingSum, rating2Sum, ratingNormSq, rating2NormSq)
        val regCorr = regularizedCorrelation(size, dotProduct, ratingSum, rating2Sum,
          ratingNormSq, rating2NormSq, PRIOR_COUNT, PRIOR_CORRELATION)
        val cosSim = cosineSimilarity(dotProduct, scala.math.sqrt(ratingNormSq), scala.math.sqrt(rating2NormSq))
        val jaccard = jaccardSimilarity(size, numRaters, numRaters2)

        (key, (corr, regCorr, cosSim, jaccard))
      })
  def evaluateModel(movieName: String): Unit = {
    // test a few movies out (substitute the contains call with the relevant movie name
    val sample = similarities.filter(m => {
      val movies = m._1
      (movieNames(movies._1).contains(movieName))
    })

    // collect results, excluding NaNs if applicable
    val result = sample.map(v => {
      val m1 = v._1._1
      val m2 = v._1._2
      val corr = v._2._1
      val rcorr = v._2._2
      val cos = v._2._3
      val j = v._2._4
      (movieNames(m1), movieNames(m2), corr, rcorr, cos, j)
    }).collect().filter(e => !(e._4 equals Double.NaN)) // test for NaNs must use equals rather than ==
      .sortBy(elem => elem._4).take(10)

    // print the top 10 out
    result.foreach(r => println(r._1 + " | " + r._2 + " | " + r._3.formatted("%2.4f") + " | " + r._4.formatted("%2.4f")
      + " | " + r._5.formatted("%2.4f") + " | " + r._6.formatted("%2.4f")))
  }

  // *************************
  // * SIMILARITY MEASURES
  // *************************

  /**
   * The correlation between two vectors A, B is
   *   cov(A, B) / (stdDev(A) * stdDev(B))
   *
   * This is equivalent to
   *   [n * dotProduct(A, B) - sum(A) * sum(B)] /
   *     sqrt{ [n * norm(A)^2 - sum(A)^2] [n * norm(B)^2 - sum(B)^2] }
   */
  def correlation(size: Double, dotProduct: Double, ratingSum: Double,
                  rating2Sum: Double, ratingNormSq: Double, rating2NormSq: Double) = {

    val numerator = size * dotProduct - ratingSum * rating2Sum
    val denominator = scala.math.sqrt(size * ratingNormSq - ratingSum * ratingSum) *
      scala.math.sqrt(size * rating2NormSq - rating2Sum * rating2Sum)

    numerator / denominator
  }

  /**
   * Regularize correlation by adding virtual pseudocounts over a prior:
   *   RegularizedCorrelation = w * ActualCorrelation + (1 - w) * PriorCorrelation
   * where w = # actualPairs / (# actualPairs + # virtualPairs).
   */
  def regularizedCorrelation(size: Double, dotProduct: Double, ratingSum: Double,
                             rating2Sum: Double, ratingNormSq: Double, rating2NormSq: Double,
                             virtualCount: Double, priorCorrelation: Double) = {

    val unregularizedCorrelation = correlation(size, dotProduct, ratingSum, rating2Sum, ratingNormSq, rating2NormSq)
    val w = size / (size + virtualCount)

    w * unregularizedCorrelation + (1 - w) * priorCorrelation
  }

  /**
   * The cosine similarity between two vectors A, B is
   *   dotProduct(A, B) / (norm(A) * norm(B))
   */
  def cosineSimilarity(dotProduct: Double, ratingNorm: Double, rating2Norm: Double) = {
    dotProduct / (ratingNorm * rating2Norm)
  }

  /**
   * The Jaccard Similarity between two sets A, B is
   *   |Intersection(A, B)| / |Union(A, B)|
   */
  def jaccardSimilarity(usersInCommon: Double, totalUsers1: Double, totalUsers2: Double) = {
    val union = totalUsers1 + totalUsers2 - usersInCommon
    usersInCommon / union
  }

  def main(args: Array[String]): Unit = {
    evaluateModel("Die Hard (1988)")
    evaluateModel("Postino, Il (1994)")
    evaluateModel("Star Wars (1977)")
  }

}